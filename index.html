<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>One Second Student Report</title>
    <!-- Your existing meta tags, links, etc. -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #ffffff;
            color: #000000;
        }
        .btn-primary {
            background-color: #000000; color: #ffffff; border: 1px solid #000000;
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            background-color: #333333; transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        .sentence-ai { background-color: #ffcccc; }
        .sentence-human { background-color: #ccffcc; }

        /* --- NEW MODAL STYLES --- */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        .modal-content {
            background: white;
            padding: 2rem;
            border-radius: 1rem;
            max-width: 500px;
            width: 90%;
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }
        .modal-overlay.active .modal-content {
            transform: scale(1);
        }
    </style>
</head>

<body class="overflow-x-hidden">

    <!-- HERO SECTION -->
    <section class="text-center pt-10 pb-20 bg-gray-50">
        <div class="container mx-auto px-6">
            <div class="max-w-5xl mx-auto">
                <h1 class="text-5xl md:text-7xl mb-8 leading-tight font-black">
                    Identify Assignment
                    <span class="relative inline-block">in 1 Second</span>
                </h1>
                <p class="max-w-4xl mx-auto text-xl md:text-2xl text-gray-700 mb-12 leading-relaxed">
                    Teachers can now see students assignments in one second whether they wrote honestly or not.
                </p>
                <!-- NEW: Call to Action Button -->
                <button id="get-started-btn" class="btn-primary text-xl font-bold px-10 py-4 rounded-xl">
                    Get Started Now
                </button>
            </div>

            <!-- DEMO CONTENT (Animation) -->
            <div class="mt-12">
                <!-- Step indicators, etc. -->
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <!-- Step 1: Student Submission -->
                    <div class="text-center">
                        <div class="bg-white p-6 rounded-2xl shadow-lg h-96 relative overflow-hidden border">
                            <div id="student-text" class="text-left font-mono text-sm h-64 overflow-y-auto whitespace-pre-wrap"></div>
                        </div>
                    </div>
                    <!-- Step 2: Analysis -->
                    <div class="text-center">
                        <div class="bg-white p-6 rounded-2xl shadow-lg h-96 relative overflow-hidden border flex flex-col justify-center">
                            <!-- ... Your analysis animation content ... -->
                        </div>
                    </div>
                    <!-- Step 3: One Second Report -->
                    <div class="text-center">
                        <div class="bg-white p-6 rounded-2xl shadow-lg h-96 relative overflow-hidden border">
                            <div id="report-output" class="text-left h-64 overflow-y-auto text-sm whitespace-pre-wrap p-3 bg-gray-50 rounded-lg">
                                Report will appear here...
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- FOOTER -->
    <footer class="bg-white border-t border-gray-200">
        <!-- ... Your footer content ... -->
    </footer>

    <!-- NEW: EMAIL MODAL -->
    <div id="email-modal" class="modal-overlay">
        <div class="modal-content text-center">
            <h2 class="text-3xl font-bold mb-4">Get Access</h2>
            <p class="text-gray-600 mb-6">Enter your email to start your free trial or subscribe to unlock all features.</p>
            <form id="email-form" class="space-y-4">
                <input type="email" id="email-input" placeholder="your@email.com" required
                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-black">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <button type="submit" data-action="trial" class="btn-primary w-full py-3 rounded-lg font-semibold">
                        Start Free Trial
                    </button>
                    <button type="submit" data-action="checkout" class="bg-gray-200 text-black w-full py-3 rounded-lg font-semibold hover:bg-gray-300">
                        Subscribe Now
                    </button>
                </div>
            </form>
            <button id="close-modal-btn" class="absolute top-4 right-4 text-gray-500 hover:text-black">&times;</button>
        </div>
    </div>


    <script>
        // --- Your existing demo animation script ---
        const studentText = `The Industrial Revolution was a major turning point in history...`; // Truncated for brevity
        const reportText = `The Industrial Revolution was a major turning point in history...`;
        
        const studentTextEl = document.getElementById('student-text');
        const reportOutputEl = document.getElementById('report-output');

        function runDemo() {
            // ... (keep all your existing animation logic here)
            // This will continue to run on page load
        }
        
        window.addEventListener('load', runDemo);
        // --- End of your existing script ---


        // --- NEW SCRIPT FOR MODAL AND PAYMENT INTEGRATION ---
        
        // IMPORTANT: Replace this with the URL of your deployed Cloudflare Worker
        const WORKER_BASE_URL = "https://my-worker.your-account.workers.dev";

        const getStartedBtn = document.getElementById('get-started-btn');
        const emailModal = document.getElementById('email-modal');
        const emailForm = document.getElementById('email-form');
        const emailInput = document.getElementById('email-input');
        
        // Function to show the modal
        const showModal = () => {
            emailModal.classList.add('active');
        };
        
        // Function to hide the modal
        const hideModal = () => {
            emailModal.classList.remove('active');
        };

        // Event listener to open the modal
        getStartedBtn.addEventListener('click', showModal);

        // Event listener to close the modal if clicking on the overlay
        emailModal.addEventListener('click', (e) => {
            if (e.target === emailModal) {
                hideModal();
            }
        });

        // Event listener for the form submission
        emailForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const email = emailInput.value;
            if (!email) {
                alert('Please enter a valid email address.');
                return;
            }
            
            // Determine which button was clicked (Trial or Checkout)
            const action = e.submitter.dataset.action;

            if (action === 'trial') {
                // For a free trial, we check the user's status.
                // The worker will automatically start a trial if the user is new.
                // It will then serve the page with an iframe to demo.imaginea.store/track
                window.location.href = `${WORKER_BASE_URL}/?email=${encodeURIComponent(email)}`;
            
            } else if (action === 'checkout') {
                // For checkout, we redirect to the worker's checkout endpoint.
                // The worker will then redirect to the DodoPayment page.
                window.location.href = `${WORKER_BASE_URL}/checkout?email=${encodeURIComponent(email)}`;
            }
        });

        // Check if a user is returning after a successful payment
        // This logic permanently redirects paid users to the app.
        (async () => {
            const email = new URLSearchParams(window.location.search).get('email');
            if (email) {
                try {
                    // Ask the worker for the user's access status
                    const response = await fetch(`${WORKER_BASE_URL}/api/check-access`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ email: email })
                    });
                    
                    const data = await response.json();
                    
                    // If the user has paid ('paid' type), redirect them immediately.
                    if (data.hasAccess && data.type === 'paid') {
                        // The worker's root URL handles showing the correct page
                        window.location.href = `${WORKER_BASE_URL}/?email=${encodeURIComponent(email)}`;
                    }
                } catch (error) {
                    console.error('Failed to check access status:', error);
                }
            }
        })();

    </script>
</body>
</html>